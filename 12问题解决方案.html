<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>问题解决方案 | Infomover 帮助文档</title>
    <meta name="generator" content="VuePress 1.9.7">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.2/jquery.fancybox.min.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.2/jquery.fancybox.min.css">
    <meta name="description" content="Infomover功能说明以及使用过程中遇到的问题解答">
    
    <link rel="preload" href="/help/assets/css/0.styles.5932944c.css" as="style"><link rel="preload" href="/help/assets/js/app.0f366fef.js" as="script"><link rel="preload" href="/help/assets/js/2.4c34d73e.js" as="script"><link rel="preload" href="/help/assets/js/9.736391dc.js" as="script"><link rel="prefetch" href="/help/assets/js/10.aca0cb44.js"><link rel="prefetch" href="/help/assets/js/11.98c4167f.js"><link rel="prefetch" href="/help/assets/js/12.e7043ec7.js"><link rel="prefetch" href="/help/assets/js/13.c85e502e.js"><link rel="prefetch" href="/help/assets/js/14.da4cdf49.js"><link rel="prefetch" href="/help/assets/js/15.0caa3228.js"><link rel="prefetch" href="/help/assets/js/16.d5314189.js"><link rel="prefetch" href="/help/assets/js/17.cc620383.js"><link rel="prefetch" href="/help/assets/js/18.4ec05b65.js"><link rel="prefetch" href="/help/assets/js/19.3af197bc.js"><link rel="prefetch" href="/help/assets/js/3.2802b4fd.js"><link rel="prefetch" href="/help/assets/js/4.8aeb52e3.js"><link rel="prefetch" href="/help/assets/js/5.27e6d2ad.js"><link rel="prefetch" href="/help/assets/js/6.ea710b26.js"><link rel="prefetch" href="/help/assets/js/7.c7e2bfaf.js"><link rel="prefetch" href="/help/assets/js/8.ad237d01.js">
    <link rel="stylesheet" href="/help/assets/css/0.styles.5932944c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/help/" class="home-link router-link-active"><!----> <span class="site-name">Infomover 帮助文档</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>目录结构</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/help/1概述和登录页.html" class="sidebar-link">系统功能概述</a></li><li><a href="/help/2数据源—新建数据源.html" class="sidebar-link">数据源</a></li><li><a href="/help/3删除数据源.html" class="sidebar-link">删除数据源</a></li><li><a href="/help/4任务列表.html" class="sidebar-link">任务</a></li><li><a href="/help/5告警.html" class="sidebar-link">告警</a></li><li><a href="/help/6集群管理.html" class="sidebar-link">集群</a></li><li><a href="/help/7用户管理.html" class="sidebar-link">用户管理</a></li><li><a href="/help/8任务参数说明.html" class="sidebar-link">任务参数说明</a></li><li><a href="/help/9源端数据库对接说明.html" class="sidebar-link">源端数据库对接说明</a></li><li><a href="/help/10目标端数据库对接说明.html" class="sidebar-link">目标端数据库对接授权说明</a></li><li><a href="/help/11KAFKA授权对接说明.html" class="sidebar-link">Kafka集群对接授权操作</a></li><li><a href="/help/12问题解决方案.html" class="active sidebar-link">问题解决方案</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/help/12问题解决方案.html#配置类问题" class="sidebar-link">配置类问题</a></li><li class="sidebar-sub-header"><a href="/help/12问题解决方案.html#任务运行过程问题" class="sidebar-link">任务运行过程问题</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="问题解决方案"><a href="#问题解决方案" class="header-anchor">#</a> 问题解决方案</h1> <h2 id="配置类问题"><a href="#配置类问题" class="header-anchor">#</a> 配置类问题</h2> <h3 id="数据同步任务"><a href="#数据同步任务" class="header-anchor">#</a> 数据同步任务</h3> <p>没有跑通, 也没有具体的报错（版本&gt;=1.0已修复）</p> <p>排查原因：</p> <p>1. 集群配置：目前Connector和Kafka是有绑定关系的（鉴权失败的报错）；</p> <p><img src="6d2da039a7d680e8d3146de6c56d4765.png" alt="">2. 采集数据库的用户带有特殊字符，同步任务的Connector会存在问题（同步的connect没有日志信息）。</p> <p><img src="2019549e5066097316422d250683e278.png" alt=""></p> <p>直接原因：特殊字符导致Kafka topic创建失败。</p> <p>根本原因：创建Topic带有#的特殊字符，C##DBZUSER这个用户应该只具有连接的功能。</p> <p>解决方式：建议不要使用带有特殊字符的schema，后续的版本中会提示11g不要使用这个用户的schema。</p> <h3 id="mysql8-0采集用户权限问题"><a href="#mysql8-0采集用户权限问题" class="header-anchor">#</a> MySQL8.0采集用户权限问题</h3> <p>you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation</p> <p>日志报错Access denied;you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation;</p> <p>原因：采集用户需要权限（从库开启数据采集也是同样的授权过程）；</p> <p>解决方式：在数据库中执行授权语句（注意：报错提示需要RELOAD or FLUSH_TABLES权限，MySQL8.0才有FLUSH_TABLES权限，但是这里有RELOAD权限后可以不给FLUSH_TABLES权限）：</p> <p>GRANT <strong>SELECT, RELOAD, SHOW DATABASES, REPLICATION SLAVE, REPLICATION CLIENT</strong> ON *.* TO 'dsg' IDENTIFIED BY 'password';</p> <p><img src="fb01b6049a3c27bb96a95735465d12b5.png" alt=""></p> <h3 id="mysql同步至postgresql-oracle"><a href="#mysql同步至postgresql-oracle" class="header-anchor">#</a> MySQL同步至PostgreSQL/Oracle</h3> <p>connector报错：PK mode for table ‘tablename’ is RECORD_KEY with configured PK fields [xxx], but record key schema does not contain field: xxx</p> <p>查看MySQL表的主键是否有大小写敏感，配置正确的主键即可。</p> <p>show global variables like '%lower_case%';</p> <p>+------------------------+-------+</p> <p>| Variable_name | Value |</p> <p>+------------------------+-------+</p> <p>| lower_case_file_system | ON |</p> <p>| lower_case_table_names | 0 |</p> <p>+------------------------+-------+</p> <h3 id="clusterauthorizationexception"><a href="#clusterauthorizationexception" class="header-anchor">#</a> ClusterAuthorizationException</h3> <p>ClusterAuthorizationException: Cluster authorization failed.</p> <p>报错信息包含: Cluster authorization failed.Creation of database history topic failed, please create the topic manually</p> <p>原因分析：Kafka集群中用户权限不足，需要cluster相关权限。</p> <p>解决方式：授权</p> <p>bin/kafka-acls.sh --authorizer-properties zookeeper.connect=zookeeper:2181 --add --allow-principalUser:pocuser --cluster</p> <h3 id="pg采集任务报错"><a href="#pg采集任务报错" class="header-anchor">#</a> PG采集任务报错</h3> <p>ConnectException: Publication autocreation is disabled</p> <p>报错信息包含:</p> <p>ERROR org.apache.kafka.connect.errors.ConnectException: Publication autocreation is disabled, please create one and restart the connector</p> <p>原因分析：PG采集时需要在源端数据库中创建Publication。</p> <p>解决方式：Connector创建Publication可由参数“发布自动创建模式”控制，由Connector任务自行创建需要CREATE授权（GRANT CREATE ON DATABASE pgdb TO dbz4coll;）并将该参数设为“all_tables”或“filtered”，任务发布者在发布任务前或任务失败后可在源端数据库中创建Publication，名称需与“出版物”参数值（默认为dbz_publication）一致；</p> <p>参考<a href="#_%E5%8F%91%E5%B8%83%E7%9B%AE%E6%A0%87%E8%A1%A8">发布目标表</a>：</p> <table><thead><tr><th>-- -- 方式一：创建包含所有表的发布（发布方式二选一，名称与dbz参数publication.name的值一致） CREATE PUBLICATION dbz_publication FOR ALL TABLES; -- -- 方式二：发布指定表 CREATE PUBLICATION dbz_publication; ALTER PUBLICATION dbz_publication ADD TABLE all_datatype;</th></tr></thead> <tbody></tbody></table> <h2 id="任务运行过程问题"><a href="#任务运行过程问题" class="header-anchor">#</a> 任务运行过程问题</h2> <h3 id="debeziumexception"><a href="#debeziumexception" class="header-anchor">#</a> DebeziumException</h3> <p>The db history topic is missing. You may attempt to recover it by reconfiguring the connector to SCHEMA_ONLY_RECOVERY</p> <p><a data-fancybox="" title="xx" href="sss"><img src="b123a8a221a7a4e028ee0a159744058b.png" alt="22222222"></a></p> <p>可能出现这种问题的场景：</p> <ol><li>Connector重启，Kafka Topic: history schema命名发生改变；
<ol><li>采集的表删除重建/表结构变更；</li></ol></li></ol> <p>解决方式：</p> <ol><li>将快照模式改为“SCHEMA_ONLY_RECOVERY”，刷新配置；
<ol><li>使用“重新采集”功能。</li></ol></li></ol> <h3 id="任务重新采集报错"><a href="#任务重新采集报错" class="header-anchor">#</a> 任务重新采集报错</h3> <p>TopicAuthorizationException</p> <p>重新采集时出现以下报错：</p> <p><img src="7aa33ccf2809c7a47604fad257d44edb.png" alt=""></p> <p>原因分析：重新采集功能使用时，topic数据需要通过DeleteRecords的API进行offset重置，因此需要授权topic资源的Delete操作权限。</p> <p>解决方式：授权Topic资源的Delete操作权限。</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/help/11KAFKA授权对接说明.html" class="prev">
        Kafka集群对接授权操作
      </a></span> <!----></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/help/assets/js/app.0f366fef.js" defer></script><script src="/help/assets/js/2.4c34d73e.js" defer></script><script src="/help/assets/js/9.736391dc.js" defer></script>
  </body>
</html>
