(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{445:function(t,a,e){"use strict";e.r(a);var o=e(33),r=Object(o.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"问题解决方案"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#问题解决方案"}},[t._v("#")]),t._v(" 问题解决方案")]),t._v(" "),a("h2",{attrs:{id:"配置类问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置类问题"}},[t._v("#")]),t._v(" 配置类问题")]),t._v(" "),a("h3",{attrs:{id:"数据同步任务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#数据同步任务"}},[t._v("#")]),t._v(" 数据同步任务")]),t._v(" "),a("p",[t._v("没有跑通, 也没有具体的报错（版本>=1.0已修复）")]),t._v(" "),a("p",[t._v("排查原因：")]),t._v(" "),a("p",[t._v("1. 集群配置：目前Connector和Kafka是有绑定关系的（鉴权失败的报错）；")]),t._v(" "),a("p",[a("img",{attrs:{src:"6d2da039a7d680e8d3146de6c56d4765.png",alt:""}}),t._v("2. 采集数据库的用户带有特殊字符，同步任务的Connector会存在问题（同步的connect没有日志信息）。")]),t._v(" "),a("p",[a("img",{attrs:{src:"2019549e5066097316422d250683e278.png",alt:""}})]),t._v(" "),a("p",[t._v("直接原因：特殊字符导致Kafka topic创建失败。")]),t._v(" "),a("p",[t._v("根本原因：创建Topic带有#的特殊字符，C##DBZUSER这个用户应该只具有连接的功能。")]),t._v(" "),a("p",[t._v("解决方式：建议不要使用带有特殊字符的schema，后续的版本中会提示11g不要使用这个用户的schema。")]),t._v(" "),a("h3",{attrs:{id:"mysql8-0采集用户权限问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mysql8-0采集用户权限问题"}},[t._v("#")]),t._v(" MySQL8.0采集用户权限问题")]),t._v(" "),a("p",[t._v("you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation")]),t._v(" "),a("p",[t._v("日志报错Access denied;you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation;")]),t._v(" "),a("p",[t._v("原因：采集用户需要权限（从库开启数据采集也是同样的授权过程）；")]),t._v(" "),a("p",[t._v("解决方式：在数据库中执行授权语句（注意：报错提示需要RELOAD or FLUSH_TABLES权限，MySQL8.0才有FLUSH_TABLES权限，但是这里有RELOAD权限后可以不给FLUSH_TABLES权限）：")]),t._v(" "),a("p",[t._v("GRANT "),a("strong",[t._v("SELECT, RELOAD, SHOW DATABASES, REPLICATION SLAVE, REPLICATION CLIENT")]),t._v(" ON *.* TO 'dsg' IDENTIFIED BY 'password';")]),t._v(" "),a("p",[a("img",{attrs:{src:"fb01b6049a3c27bb96a95735465d12b5.png",alt:""}})]),t._v(" "),a("h3",{attrs:{id:"mysql同步至postgresql-oracle"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mysql同步至postgresql-oracle"}},[t._v("#")]),t._v(" MySQL同步至PostgreSQL/Oracle")]),t._v(" "),a("p",[t._v("connector报错：PK mode for table ‘tablename’ is RECORD_KEY with configured PK fields [xxx], but record key schema does not contain field: xxx")]),t._v(" "),a("p",[t._v("查看MySQL表的主键是否有大小写敏感，配置正确的主键即可。")]),t._v(" "),a("p",[t._v("show global variables like '%lower_case%';")]),t._v(" "),a("p",[t._v("+------------------------+-------+")]),t._v(" "),a("p",[t._v("| Variable_name | Value |")]),t._v(" "),a("p",[t._v("+------------------------+-------+")]),t._v(" "),a("p",[t._v("| lower_case_file_system | ON |")]),t._v(" "),a("p",[t._v("| lower_case_table_names | 0 |")]),t._v(" "),a("p",[t._v("+------------------------+-------+")]),t._v(" "),a("h3",{attrs:{id:"clusterauthorizationexception"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#clusterauthorizationexception"}},[t._v("#")]),t._v(" ClusterAuthorizationException")]),t._v(" "),a("p",[t._v("ClusterAuthorizationException: Cluster authorization failed.")]),t._v(" "),a("p",[t._v("报错信息包含: Cluster authorization failed.Creation of database history topic failed, please create the topic manually")]),t._v(" "),a("p",[t._v("原因分析：Kafka集群中用户权限不足，需要cluster相关权限。")]),t._v(" "),a("p",[t._v("解决方式：授权")]),t._v(" "),a("p",[t._v("bin/kafka-acls.sh --authorizer-properties zookeeper.connect=zookeeper:2181 --add --allow-principalUser:pocuser --cluster")]),t._v(" "),a("h3",{attrs:{id:"pg采集任务报错"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pg采集任务报错"}},[t._v("#")]),t._v(" PG采集任务报错")]),t._v(" "),a("p",[t._v("ConnectException: Publication autocreation is disabled")]),t._v(" "),a("p",[t._v("报错信息包含:")]),t._v(" "),a("p",[t._v("ERROR org.apache.kafka.connect.errors.ConnectException: Publication autocreation is disabled, please create one and restart the connector")]),t._v(" "),a("p",[t._v("原因分析：PG采集时需要在源端数据库中创建Publication。")]),t._v(" "),a("p",[t._v("解决方式：Connector创建Publication可由参数“发布自动创建模式”控制，由Connector任务自行创建需要CREATE授权（GRANT CREATE ON DATABASE pgdb TO dbz4coll;）并将该参数设为“all_tables”或“filtered”，任务发布者在发布任务前或任务失败后可在源端数据库中创建Publication，名称需与“出版物”参数值（默认为dbz_publication）一致；")]),t._v(" "),a("p",[t._v("参考"),a("a",{attrs:{href:"#_%E5%8F%91%E5%B8%83%E7%9B%AE%E6%A0%87%E8%A1%A8"}},[t._v("发布目标表")]),t._v("：")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("-- -- 方式一：创建包含所有表的发布（发布方式二选一，名称与dbz参数publication.name的值一致） CREATE PUBLICATION dbz_publication FOR ALL TABLES; -- -- 方式二：发布指定表 CREATE PUBLICATION dbz_publication; ALTER PUBLICATION dbz_publication ADD TABLE all_datatype;")])])]),t._v(" "),a("tbody")]),t._v(" "),a("h2",{attrs:{id:"任务运行过程问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#任务运行过程问题"}},[t._v("#")]),t._v(" 任务运行过程问题")]),t._v(" "),a("h3",{attrs:{id:"debeziumexception"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#debeziumexception"}},[t._v("#")]),t._v(" DebeziumException")]),t._v(" "),a("p",[t._v("The db history topic is missing. You may attempt to recover it by reconfiguring the connector to SCHEMA_ONLY_RECOVERY")]),t._v(" "),a("p",[a("a",{attrs:{"data-fancybox":"",title:"xx",href:"sss"}},[a("img",{attrs:{src:"b123a8a221a7a4e028ee0a159744058b.png",alt:"22222222"}})])]),t._v(" "),a("p",[t._v("可能出现这种问题的场景：")]),t._v(" "),a("ol",[a("li",[t._v("Connector重启，Kafka Topic: history schema命名发生改变；\n"),a("ol",[a("li",[t._v("采集的表删除重建/表结构变更；")])])])]),t._v(" "),a("p",[t._v("解决方式：")]),t._v(" "),a("ol",[a("li",[t._v("将快照模式改为“SCHEMA_ONLY_RECOVERY”，刷新配置；\n"),a("ol",[a("li",[t._v("使用“重新采集”功能。")])])])]),t._v(" "),a("h3",{attrs:{id:"任务重新采集报错"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#任务重新采集报错"}},[t._v("#")]),t._v(" 任务重新采集报错")]),t._v(" "),a("p",[t._v("TopicAuthorizationException")]),t._v(" "),a("p",[t._v("重新采集时出现以下报错：")]),t._v(" "),a("p",[a("img",{attrs:{src:"7aa33ccf2809c7a47604fad257d44edb.png",alt:""}})]),t._v(" "),a("p",[t._v("原因分析：重新采集功能使用时，topic数据需要通过DeleteRecords的API进行offset重置，因此需要授权topic资源的Delete操作权限。")]),t._v(" "),a("p",[t._v("解决方式：授权Topic资源的Delete操作权限。")])])}),[],!1,null,null,null);a.default=r.exports}}]);